<div class="container">
  <section class="btns-crumbs visible-md visible-lg">
    <div class="row">
      <%= render 'shared/user_menu' %>
      <div class="col-sm-5 col-md-6 nopadding-left">
        <ol class="breadcrumb">
          <li><a href="#">Courses</a></li>
          <li><a href="#">Excel</a></li>
          <li><a href="#">Get to know your workplace</a></li>
          <li class="active">Know your worksheet</li>
        </ol>
      </div>
      <% unless @user_subscription.blank? %>
        <div class="col-sm-2 col-md-2 nopadding-left">
          <div class="sub-ends">
            <p class="text-center"><a href="#">Subscription Ends: <b><%= @user_subscription[0].expiry_date.strftime("%a, %w %B, %Y") %></b></a></p>
          </div>
        </div>
      <% end %>
    </div>
  </section>
  <section class="course-menu-videos">
    <div class="seperator10 visible-xs"></div>
    <div class="row row-offcanvas row-offcanvas-left">
      <%= render 'topics_accordion' %>
      <!--/span-->
      <div class="col-xs-12 col-sm-7 col-md-8">
        <div class="view-course">
          <%= render 'video_options' %>
          <!-- rows ends -->
          <div class="row">
            <div class="col-sm-12">
              <div class="place-video">
                <iframe src="<%= vimeo_iframe_url %>" id="player_1" width="1280" height="720" frameborder="0" title="Brad!" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>
              </div>
            </div>
            <!-- col-12 ends -->
          </div>
          <!-- row ends -->
          <%= render 'course_header' %>
          <!-- col-7 ends -->
        </div>
        <!-- row ends -->
      </div>
    </div>
    <!--/row-->
  </section>
  <%= render 'recommended_videos'%>
</div>

<%= javascript_include_tag "application/main_app/course.js"%>

<script>
  $( document ).ready(function() {
    // Listen for the ready event for any vimeo video players on the page
    var player = $('#player_1')[0];
    $f(player).addEvent('ready', ready);

    function ready(player_id) {
        var froogaloop = $f(player_id);

        function onPlay(watch_url, history_url) {
          froogaloop.addEvent('play', function(data) {
            watch_list(watch_url)
            history(history_url)
          });
        }

        function watch_list(url){
          if($("#watch_list_btn").data("watch") == true){
            $.ajax({
              url: url
            });
            $("#watch_list_btn").data("watch", false);
            $('#remove_watch_lator').hide();
            $("#watch_lator").show();
          }
        }

        function history(url){
          if($("#history_btn").data("watch") == false){
            $.ajax({
              url: url
            });
            $("#history_btn").data("watch", true);
          }
        }
        onPlay("<%= remove_from_watch_list_url(@video.id, @course.id) << '.js' %>", "<%= save_history_url(@video) << '.js' %>");
    }
  });
</script>